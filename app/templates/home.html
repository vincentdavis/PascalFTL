{% extends "base.html" %}
{% block content %}
<!--Row 1-->
<div class="row">
  <div class="col">
    <div id="Leaderboard" class="card">
      <h2>Leaderboard</h2>
      {% if winners %}
      <table>
        <thead><tr><th>Player</th><th>Wins</th></tr></thead>
        <tbody>
        {% for name, count in winners %}
        <tr><td>{{ name or 'Unknown' }}</td><td>{{ count }}</td></tr>
        {% endfor %}
        </tbody>
      </table>
      {% else %}
      <p class="muted">No games completed yet.</p>
      {% endif %}
    </div>
  </div>
  <div class="col">
    <div id="recent_games" class="card">
      <h2>Recent Games</h2>
      {% if recent %}
      <ul>
        {% for g in recent %}
          {% set losers = g.players | rejectattr('name', 'equalto', g.winner_name) | map(attribute='name') | list %}
          <li>
            <span class="mono">{{ g.code }}</span>
            — Winner: <strong>{{ g.winner_name or 'TBD' }}</strong>
            {% if losers and losers|length > 0 %}
              — {{ 'Loser' if losers|length == 1 else 'Losers' }}: <strong>{{ losers | join(', ') }}</strong>
            {% endif %}
            <a href="/game_over/{{ g.code }}">View</a>
          </li>
        {% endfor %}
      </ul>
      {% else %}
        <p class="muted">No recent games.</p>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
